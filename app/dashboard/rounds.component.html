<div class="alert" [hidden]="rounds">
    <p><strong>Hint:</strong> This is where you setup matches. Roundrobin uses berger tables to setup matches between <strong>all</strong>        players, while monrad sets up a predetermined number of rounds where players of equal strength meet.
    </p>
    <p>When you're ready, click one of the buttons below to setup matches.</p>
</div>

<div class="alert" [hidden]="!rounds">
    <p><strong>Hint:</strong> You have now setup matches! When using roundrobin system, all players are matched immidiately,
        while monrad sets up one round at the time. Click on "white", "draw" or "black" to enter results.
    </p>
    <p>Check out current score at any time on the "Score" tab (top navigation).</p>
</div>

<fieldset class="form--inline">
    <legend>Match setup</legend>
    <p [hidden]="rounds">
        <button (click)="roundsAction.emit('roundrobin')" [disabled]="((nPlayers < 3) || (nPlayers > 30))" class="hide--xsm button--bordered button--affix button--full">
            Setup roundrobin
            <span class="affix" *ngIf="(nPlayers > 2) && (nPlayers < 31)">{{roundrobinRounds}} rounds</span>
        </button>
        <button (click)="roundsAction.emit('roundrobin')" [disabled]="((nPlayers < 3) || (nPlayers > 30))" class="show--xsm button--bordered button--full">
            Setup roundrobin
        </button>
    </p>
    <p [hidden]="rounds">
        <button [disabled]="nPlayers < 7" (click)="roundsAction.emit(monradRounds)" class="hide--xsm button--bordered button--affix button--full">
            Setup monrad
            <span class="affix">{{monradRounds}} rounds</span>
        </button>
        <button [disabled]="nPlayers < 7" (click)="roundsAction.emit(monradRounds)" class="show--xsm button--bordered button--full">
            Setup monrad
        </button>
    </p>
    <p [hidden]="rounds">
        <label>Number of rounds:</label>
        <input [disabled]="(players | asArray).length < 8" #range min="4" value="4" [max]="((players | asArray).length / 2) +1" type="range" (change)="monradRounds = range.value">
    </p>
    <p *ngIf="system > 0">
        <button [disabled]="system == rounds.length" (click)="roundsAction.emit('nextMonrad')" class="button--bordered button--full">
            Setup next round
        </button>
    </p>
    <p *ngIf="system > 0">
        <button [hidden]="rounds.length == 1" (click)="roundsAction.emit('clearLast')" class="button--bordered border--error button--full">
            Clear last round
        </button>
    </p>
    <p [hidden]="!rounds">
        <button data-hint="Remove all rounds and matches (irreversible!)" (click)="roundsAction.emit('clear')" class="button--bordered border--error button--full tooltip--bottom">Clear rounds!</button>
    </p>
</fieldset>

<fieldset [hidden]="!rounds">

    <legend>Matches and results</legend>

    <ul class="group">
        <li *ngFor="#round of rounds; #r = index;" [class.is-active]="visibleRound == r" class="group-item" (click)="visibleRound = r">
            Round {{r+1}}
        </li>
    </ul>

    <div [hidden]="r != visibleRound" *ngFor="#round of rounds; #r = index">

        <div *ngFor="#match of round; #m = index">
            <div *ngIf="match.result != 'bye'">
                
                <div class="text--center">
                    Table {{m+1}}:
                    <a [hidden]="match.result == 0" class="text--success text--error" (click)="match.result = 0; dataChange.emit({rounds: rounds})">
                        <small>(clear result)</small>
                    </a>
                </div>
                <p class="hide--xsm"></p>

                <div class="row">
                    <label column="3">Result:</label>
                    <table column="9" class="dc-fixed dc-match-table table--hoverCell table--border table--full text--center">
                        <tbody>
                            <tr>
                                <td [class.bg--success]="match.result == 'white'" (click)="match.result = 'white'; dataChange.emit({rounds: rounds})">
                                    <div class="right" [hidden]="match.result != 'white'">↓</div>
                                    White
                                </td>
                                <td [class.bg--success]="match.result == 'draw'" (click)="match.result = 'draw'; dataChange.emit({rounds: rounds})">
                                    <div [hidden]="match.result != 'draw'">↓</div>
                                    <div [hidden]="match.result != 'draw'" class="right">↓</div>
                                    Draw
                                </td>
                                <td [class.bg--success]="match.result == 'black'" (click)="match.result = 'black'; dataChange.emit({rounds: rounds})">
                                    <div [hidden]="match.result != 'black'">↓</div>
                                    Black
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="row">
                    <label column="3">Players:</label>
                    <table column="9" class="dc-fixed table--full text--center">
                        <tbody>
                            <tr>
                                <td class="dc-white">{{players[match.white].name}}</td>
                                <td class="dc-black">{{players[match.black].name}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <button class="button--full" style="visibility: hidden">space, pleace</button>
            </div>

        </div>
    </div>

</fieldset>